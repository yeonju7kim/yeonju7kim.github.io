---
layout: post
title: detr
date: 2022-03-02 00:10:00 +0900
# category: transformer
category: ongoing
use_math: true
comments: true
---
본 포스팅은 아래 논문과 동영상을 참고했습니다.
- <https://arxiv.org/pdf/2005.12872.pdf>
- <https://www.youtube.com/watch?v=hCWUTvVrG7E&t=40s&ab_channel=%EB%8F%99%EB%B9%88%EB%82%98>

## Abstract

- object detection을 direct set prediction 문제로 본다.
- detection의 pipeline을 간소화 한다.
  - 특히 NMS(non-maximum suppression)이나 prior knowledge를 encode하는 anchor generation 과 같은 수작업이 필요한 것을 제거한다.
    <details>
    <summary>
        NMS
    </summary>
    - bounding box 리스트 B에서 가장 score가 높은 것을 D로 옯기고, 그것과 B안의 원소들의 iou를 비교하여 threshold가 넘으면 B에서 삭제한다.
    - B안의 모든 원소를 확인하면 B에 남은 bounding box 중 score가 가장 높은 것을 D로 옮기고, 앞에서 한 과정을 다시 한다. 
  </details>
- DETR의 큰 특징은 partite matching과 transformer를 사용한다는 것이다.
  - transformer를 사용하기 때문에 parallel하게 계산할 수 있다.
- Fast R-CNN과 비슷한 accruacy와 run-time performance를 보여줬다.
- panoptic segmentation도 가능하다.

## 1. Introduction

- 기존에는 indirect 한 방식 사용.
  - surrogate regression, anchor, window
  - 겹쳐진 bounding box를 postprocessing 해야하는데 이것이 성능에 영향을 끼침.
- direct set prediction approach : 이분 매칭을 통해 중복되는 prediction 제거
- transformer의 self-attention은 element간의 interaction 을 계산한다. 이것은 중복된 prediction을 제거한다. 따라서 수작업이 줄어든다.
- bipartite matching loss와 parallel decoding을 사용한 transformer (기존의 작업은 autoregressive decoding with RNN 이었던 점과 대비된다.)
- 평가는 Fast R-CNN 과 비교했고, COCO 데이터 셋을 사용했다. 큰 물체는 성능이 좋았지만, 작은 물체는 성능이 좋지 않았다.
- ablation study라는 component들을 제거한후 학습해서 평가하는 방법도 사용했다.
- Training setting은 기존과 많이 달랐다.
  - training schedule(?)이 너무 길다는 문제가 있었다.
  - auxiliary decoding loss로 좋은 점도 있었다.

---

## 2. Related work

### 2.1 Set prediction

- direct set prediction은 
  - postprocessing-free하다.
  - global inference schemes가 필요하다. 따라서 기존에는 RNN과 같은 auto-regressive sequence model을 사용했다.
- Hungarian algorithm을 활용하여 bipartite maching을 했다.

### 2.3 Object Detection

- 최근 방법은 proposal을 사용했고, hand-crafted process를 거치는 방법이었다.
- detr처럼 end-to-end set prediction을 사용한 방법이 있었다. bipartite-matching loss와 encoder-decoder 구조를 사용하는 것은 비슷했다. 하지만 detr은 transformer를 이용한다는 점이 다르다.

---

## 3. The DETR model

- direct set predictions 은
  - unique matching
  - objects 집합을 예측하고, 그들의 관계를 modeling 하는 것

### 3.1
---
layout: post
title: R-CNN, Fast R-CNN, Faster R-CNN, Mask R-CNN
date: 2022-03-08 00:10:00 +0900
category: ongoing
use_math: true
comments: true
---

본 포스팅은 아래 게시물을 참고했습니다.

- <https://ganghee-lee.tistory.com/35>
- <https://ganghee-lee.tistory.com/36>
- <https://herbwood.tistory.com/10>
- <https://herbwood.tistory.com/20>
  
---

DETR을 보다가 R-CNN에 대해 궁금해져서 RCNN 에 대해 조사해 보게 되었습니다. 여러가지 중에서도 R-CNN, Fast R-CNN, Faster R-CNN, Mask R-CNN을 알아보겠습니다.

## Object Detection

object detection에는 1-stage detector와 2-stage detector가 있다.

### 2-stage detector
Selective search, Region proposal network 등으로 ROI를 찾고, classification 한다.
![alt text](/public/img/220308/rcnn_2stage.png)

### 1-stage detector 
RoI영역을 먼저 추출하지 않고 전체 image에 대해서 convolution network로 classification, box regression(localization)을 수행한다.
![alt text](/public/img/220308/rcnn_1stage.png)

여기서 R-CNN계열은 2-stage Detector이다.

---

## R-CNN

- Image classification을 수행하는 CNN + localization을 위한 regional proposal 알고리즘
  
![alt text](/public/img/220308/rcnn.png)

- R-CNN 과정

> 1. Image를 입력받는다.
> 2. Selective search 알고리즘에 의해 regional proposal output 약 2000개를 추출한다. 추출한 regional proposal output을 모두 동일 input size로 만들어주기 위해 warp해준다.
> 3. 2000개의 warped image를 각각 CNN 모델에 넣는다.
> 4. 각각의 Convolution 결과에 대해 (Linear SVM으로) classification을 진행하여 결과를 얻는다.

- Selective search

> 1. 패턴으로 non-object-based segmentation
> 2. Bottom-up 방식으로 small segmented areas들을 합쳐서 더 큰 segmented areas
> 3. 최종적으로 2000개의 region proposal을 생성

- Bounding box regression
Selective search로 만든 bounding box는 정확하지 않기 때문에 물체를 정확히 감싸도록 조정해주는 bounding box regression(선형회귀 모델)이 존재한다.

- 단점

1. CNN을 2000번 해야해서 시간이 오래 걸림
2. CNN, SVM, Bounding Box Regression 총 세가지의 모델이 한 번에 학습되지 않는다.

## Fast R-CNN

## Faster R-CNN

## Mask R-CNN